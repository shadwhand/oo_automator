{% extends "base.html" %}

{% block title %}OO Automator - Dashboard{% endblock %}

{% block content %}
<div class="dashboard-header">
    <h1>Dashboard</h1>
    <a href="/new-run" class="btn btn-primary">+ New Run</a>
</div>

<div class="dashboard-grid">
    <section class="tests-section">
        <h2>Recent Tests</h2>
        {% if tests %}
        <ul class="tests-list">
            {% for test in tests %}
            <li class="test-item">
                <a href="/tests/{{ test.id }}" class="test-link">
                    <div class="test-info">
                        <strong class="test-name">{{ test.name or "(unnamed)" }}</strong>
                        <span class="test-url">{{ test.url[:60] }}{% if test.url|length > 60 %}...{% endif %}</span>
                    </div>
                    <div class="test-stats">
                        <span class="run-count">{{ test.run_count }} runs</span>
                        {% if test.last_run_at %}
                        <span class="last-run">Last: {{ test.last_run_at.strftime('%Y-%m-%d %H:%M') }}</span>
                        {% endif %}
                    </div>
                </a>
            </li>
            {% endfor %}
        </ul>
        {% else %}
        <p class="empty-state">No tests yet. <a href="/new-run">Create your first run</a></p>
        {% endif %}
    </section>

    <section class="runs-section">
        <h2>Active Runs</h2>
        <div hx-get="/api/runs?status=running"
             hx-trigger="load, every 5s"
             hx-headers='{"Accept": "text/html"}'>
            <p class="loading">Loading active runs...</p>
        </div>
    </section>

    <section class="runs-section">
        <h2>Recent Runs</h2>
        <div hx-get="/api/runs"
             hx-trigger="load, every 10s"
             hx-headers='{"Accept": "text/html"}'>
            <p class="loading">Loading recent runs...</p>
        </div>
    </section>
</div>
{% endblock %}
